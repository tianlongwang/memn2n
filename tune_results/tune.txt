50, 0.5, ,
Using TensorFlow backend.
/mnt/data1/Develop/MemN2N/My/memn2n/mc_data_utils.py:172: VisibleDeprecationWarning: using a non-integer number instead of an integer will result in an error in the future
  lb[label] = 1
Started Task: 1
Load trainng data from ./data/traintest/train/mc160.train.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade2.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade2.test.0.1.json
CorrectAnswer not in 'ABC'
{u'text': u'What is compared and contrasted in the passage? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'New York City and Chicago', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'international camps and sports camps', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'weather in different parts of the world', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'The climate of Ghana is warm all year. The climate of New York City is sometimes cold. What can be concluded from this information? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'All parts of the world have the same climate.', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'Different parts of the world can have different climates.', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'The climate of New York City and the climate of England are alike.', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'Why might Ilsa like to eat ice cream in the summer? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'Ilsa likes eating something cold when the weather is hot.', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'Ilsa likes eating something warm when the weather is hot.', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'Ilsa likes eating something hot when the weather is cold.', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'What is a main idea of the story? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'eating stew in Senegal', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'visiting Argentina in the summer', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'weather around the world', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'Read these sentences: "Ilsa was excited to meet her camp counselor Itzel when she arrived for her first day at The International Camp in Forest Hills, Queens, in New York City. Itzel asked the campers to sit in a circle, introduce themselves, and share which countries their families were from." What does the word "international" mean? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'having to do with more than one country', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'having to do with being outdoors', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'having to do with playing baseball or soccer', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
Load trainng data from ./data/traintest/train/readworks_grade2.dev.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade3.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade1.test.0.1.json
Load trainng data from ./data/traintest/train/readworks_gradek.0.1.json
Load trainng data from ./data/traintest/train/mc160.dev.0.1.json
Load testing data from ./data/traintest/test/readworks_grade1.dev.0.1.json
('use pickle', 1)
Longest sentence length 128
Longest story length 171
Answer length 60
Label size 4
Training set shape (2129, 100, 128)
Training Size 2129
Validation Size 533
Testing Size 325
('q_emb', <tf.Tensor 'MemN2N2/embedding_lookup:0' shape=(?, 128, 50) dtype=float32>)
('self._encoding', <tf.Tensor 'encoding:0' shape=(128, 50) dtype=float32>)
('u_0', <tf.Tensor 'MemN2N2/Sum:0' shape=(?, 50) dtype=float32>)
('as_emb', <tf.Tensor 'MemN2N2/embedding_lookup_7:0' shape=(?, 4, 60, 50) dtype=float32>)
('self._answer_encoding', <tf.Tensor 'answer_encoding:0' shape=(60, 50) dtype=float32>)
('as_enc', <tf.Tensor 'MemN2N2/Sum_13:0' shape=(?, 4, 50) dtype=float32>)
('u_k', <tf.Tensor 'MemN2N2/Relu_2:0' shape=(?, 50) dtype=float32>)
('u_k_l', <tf.Tensor 'MemN2N2/Reshape:0' shape=(?, 4, 50) dtype=float32>)
('as_ans', <tf.Tensor 'MemN2N2/Sub:0' shape=(?, 4, 50) dtype=float32>)
('as_ans', <tf.Tensor 'MemN2N2/Sum_14:0' shape=(?, 4) dtype=float32>)
('logits', <tf.Tensor 'MemN2N2/Sum_14:0' shape=(?, 4) dtype=float32>)
-----------------------
Epoch 1
Total Cost: 1896192.76172
Training Accuracy: 0.442930953499
Validation Accuracy: 0.384615
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 2
Total Cost: 984793.458984
Training Accuracy: 0.580554250822
Validation Accuracy: 0.45591
-----------------------
Testing Accuracy: 0.372307692308
-----------------------
Epoch 3
Total Cost: 595223.762695
Training Accuracy: 0.686707374354
Validation Accuracy: 0.4803
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 4
Total Cost: 371025.34375
Training Accuracy: 0.736965711602
Validation Accuracy: 0.474672
-----------------------
Testing Accuracy: 0.406153846154
-----------------------
Epoch 5
Total Cost: 246299.737305
Training Accuracy: 0.754814466886
Validation Accuracy: 0.525328
-----------------------
Testing Accuracy: 0.403076923077
-----------------------
Epoch 6
Total Cost: 175320.543457
Training Accuracy: 0.747768905589
Validation Accuracy: 0.500938
-----------------------
Testing Accuracy: 0.387692307692
-----------------------
Epoch 7
Total Cost: 139839.003662
Training Accuracy: 0.751526538281
Validation Accuracy: 0.517824
-----------------------
Testing Accuracy: 0.4
-----------------------
Epoch 8
Total Cost: 111631.450439
Training Accuracy: 0.790511977454
Validation Accuracy: 0.551595
-----------------------
Testing Accuracy: 0.390769230769
-----------------------
Epoch 9
Total Cost: 92310.1425781
Training Accuracy: 0.805072804133
Validation Accuracy: 0.523452
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 10
Total Cost: 76137.5252686
Training Accuracy: 0.808830436825
Validation Accuracy: 0.551595
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 11
Total Cost: 59594.3201904
Training Accuracy: 0.795678722405
Validation Accuracy: 0.538462
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 12
Total Cost: 53521.1293945
Training Accuracy: 0.793799906059
Validation Accuracy: 0.549719
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 13
Total Cost: 46138.3364258
Training Accuracy: 0.820103334899
Validation Accuracy: 0.559099
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 14
Total Cost: 36730.1766357
Training Accuracy: 0.780648191639
Validation Accuracy: 0.517824
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 15
Total Cost: 33770.651062
Training Accuracy: 0.801784875528
Validation Accuracy: 0.54409
-----------------------
Testing Accuracy: 0.393846153846
-----------------------
Epoch 16
Total Cost: 29829.3101196
Training Accuracy: 0.832315641146
Validation Accuracy: 0.560976
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 17
Total Cost: 25851.3943481
Training Accuracy: 0.805072804133
Validation Accuracy: 0.570356
-----------------------
Testing Accuracy: 0.4
-----------------------
Epoch 18
Total Cost: 24307.7399292
Training Accuracy: 0.789572569281
Validation Accuracy: 0.529081
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 19
Total Cost: 22247.6759644
Training Accuracy: 0.852982620949
Validation Accuracy: 0.577861
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 20
Total Cost: 18303.5908508
Training Accuracy: 0.816345702208
Validation Accuracy: 0.577861
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 21
Total Cost: 16504.9443359
Training Accuracy: 0.854861437295
Validation Accuracy: 0.589118
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 22
Total Cost: 13240.7600403
Training Accuracy: 0.84499765148
Validation Accuracy: 0.562852
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 23
Total Cost: 11971.4356079
Training Accuracy: 0.853452325035
Validation Accuracy: 0.585366
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 24
Total Cost: 10585.8790741
Training Accuracy: 0.853452325035
Validation Accuracy: 0.598499
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 25
Total Cost: 10149.7796783
Training Accuracy: 0.832315641146
Validation Accuracy: 0.575985
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 26
Total Cost: 8807.07598877
Training Accuracy: 0.868952559887
Validation Accuracy: 0.598499
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 27
Total Cost: 7329.32383728
Training Accuracy: 0.84499765148
Validation Accuracy: 0.585366
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 28
Total Cost: 6768.42970276
Training Accuracy: 0.843118835134
Validation Accuracy: 0.587242
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 29
Total Cost: 5955.23651123
Training Accuracy: 0.801315171442
Validation Accuracy: 0.585366
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 30
Total Cost: 6157.43087006
Training Accuracy: 0.817754814467
Validation Accuracy: 0.575985
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 31
Total Cost: 5310.98495483
Training Accuracy: 0.858619069986
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 32
Total Cost: 4520.933815
Training Accuracy: 0.867073743542
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 33
Total Cost: 3956.56613159
Training Accuracy: 0.877876937529
Validation Accuracy: 0.636023
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 34
Total Cost: 3722.70552063
Training Accuracy: 0.858149365899
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.464615384615
-----------------------
Epoch 35
Total Cost: 3314.68776703
Training Accuracy: 0.858619069986
Validation Accuracy: 0.615385
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 36
Total Cost: 3348.82428741
Training Accuracy: 0.86989196806
Validation Accuracy: 0.577861
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 37
Total Cost: 3399.95157623
Training Accuracy: 0.875998121184
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 38
Total Cost: 3086.23631287
Training Accuracy: 0.87646782527
Validation Accuracy: 0.622889
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 39
Total Cost: 2800.08843994
Training Accuracy: 0.860967590418
Validation Accuracy: 0.604128
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 40
Total Cost: 2627.79684067
Training Accuracy: 0.900422733678
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 41
Total Cost: 2583.02960587
Training Accuracy: 0.888680131517
Validation Accuracy: 0.604128
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 42
Total Cost: 2696.58252335
Training Accuracy: 0.8961953969
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 43
Total Cost: 2616.31703186
Training Accuracy: 0.911695631752
Validation Accuracy: 0.639775
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 44
Total Cost: 2390.48645782
Training Accuracy: 0.896665100986
Validation Accuracy: 0.615385
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 45
Total Cost: 2444.20655441
Training Accuracy: 0.906528886801
Validation Accuracy: 0.598499
-----------------------
Testing Accuracy: 0.464615384615
-----------------------
Epoch 46
Total Cost: 2447.2436409
Training Accuracy: 0.915453264443
Validation Accuracy: 0.630394
-----------------------
Testing Accuracy: 0.464615384615
-----------------------
Epoch 47
Total Cost: 2314.28192902
Training Accuracy: 0.91592296853
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 48
Total Cost: 2091.75263214
Training Accuracy: 0.913104744011
Validation Accuracy: 0.639775
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 49
Total Cost: 2134.71850586
Training Accuracy: 0.911695631752
Validation Accuracy: 0.63227
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 50
Total Cost: 2252.12684631
Training Accuracy: 0.913104744011
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 51
Total Cost: 2288.29324722
Training Accuracy: 0.916862376703
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 52
Total Cost: 2300.27888107
Training Accuracy: 0.913574448098
Validation Accuracy: 0.621013
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 53
Total Cost: 2102.10831451
Training Accuracy: 0.921559417567
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 54
Total Cost: 1980.41479492
Training Accuracy: 0.929544387036
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 55
Total Cost: 2001.19912338
Training Accuracy: 0.945044621888
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 56
Total Cost: 1845.96160889
Training Accuracy: 0.940347581024
Validation Accuracy: 0.634146
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 57
Total Cost: 1951.00921249
Training Accuracy: 0.945514325975
Validation Accuracy: 0.634146
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 58
Total Cost: 1861.87235641
Training Accuracy: 0.949271958666
Validation Accuracy: 0.639775
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 59
Total Cost: 1756.5274353
Training Accuracy: 0.952559887271
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.48
-----------------------
Epoch 60
Total Cost: 1901.21612167
Training Accuracy: 0.94739314232
Validation Accuracy: 0.664165
-----------------------
Testing Accuracy: 0.483076923077
-----------------------
Epoch 61
Total Cost: 1925.78791809
Training Accuracy: 0.95396899953
Validation Accuracy: 0.677298
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 62
Total Cost: 1872.38088608
Training Accuracy: 0.945514325975
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 63
Total Cost: 1748.18907166
Training Accuracy: 0.945044621888
Validation Accuracy: 0.636023
-----------------------
Testing Accuracy: 0.48
-----------------------
Epoch 64
Total Cost: 1843.09497452
Training Accuracy: 0.945044621888
Validation Accuracy: 0.626642
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 65
Total Cost: 1789.53015518
Training Accuracy: 0.960075152654
Validation Accuracy: 0.645403
-----------------------
Testing Accuracy: 0.461538461538
-----------------------
Epoch 66
Total Cost: 1693.48431778
Training Accuracy: 0.947862846407
Validation Accuracy: 0.630394
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 67
Total Cost: 1841.8344574
Training Accuracy: 0.945984030061
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.461538461538
-----------------------
Epoch 68
Total Cost: 1810.56322479
Training Accuracy: 0.953029591357
Validation Accuracy: 0.626642
-----------------------
Testing Accuracy: 0.461538461538
-----------------------
Epoch 69
Total Cost: 1753.08215332
Training Accuracy: 0.944105213715
Validation Accuracy: 0.636023
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 70
Total Cost: 1661.38893509
Training Accuracy: 0.958666040395
Validation Accuracy: 0.637899
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 71
Total Cost: 1702.31613159
Training Accuracy: 0.94880225458
Validation Accuracy: 0.621013
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 72
Total Cost: 1774.5803566
Training Accuracy: 0.96054485674
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 73
Total Cost: 1690.35570908
Training Accuracy: 0.95537811179
Validation Accuracy: 0.636023
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 74
Total Cost: 1751.64339828
Training Accuracy: 0.958196336308
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 75
Total Cost: 1559.54492188
Training Accuracy: 0.968060122123
Validation Accuracy: 0.637899
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 76
Total Cost: 1588.41320992
Training Accuracy: 0.957726632222
Validation Accuracy: 0.630394
-----------------------
Testing Accuracy: 0.476923076923
-----------------------
Epoch 77
Total Cost: 1699.42082596
Training Accuracy: 0.94880225458
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 78
Total Cost: 1710.59571838
Training Accuracy: 0.958666040395
Validation Accuracy: 0.626642
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 79
Total Cost: 1549.59545898
Training Accuracy: 0.966651009864
Validation Accuracy: 0.630394
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 80
Total Cost: 1560.1016922
Training Accuracy: 0.96712071395
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 81
Total Cost: 1459.97320747
Training Accuracy: 0.951620479098
Validation Accuracy: 0.634146
-----------------------
Testing Accuracy: 0.498461538462
-----------------------
Epoch 82
Total Cost: 1598.37908554
Training Accuracy: 0.94222639737
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 83
Total Cost: 1807.68432617
Training Accuracy: 0.952559887271
Validation Accuracy: 0.634146
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 84
Total Cost: 1735.12203598
Training Accuracy: 0.917332080789
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 85
Total Cost: 1916.50890732
Training Accuracy: 0.964302489432
Validation Accuracy: 0.63227
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 86
Total Cost: 1597.23794174
Training Accuracy: 0.966181305777
Validation Accuracy: 0.652908
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 87
Total Cost: 1740.17382431
Training Accuracy: 0.951150775012
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.464615384615
-----------------------
Epoch 88
Total Cost: 1734.1513176
Training Accuracy: 0.956317519962
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 89
Total Cost: 1528.37364197
Training Accuracy: 0.963363081259
Validation Accuracy: 0.636023
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 90
Total Cost: 1532.83422661
Training Accuracy: 0.949271958666
Validation Accuracy: 0.634146
-----------------------
Testing Accuracy: 0.48
-----------------------
Epoch 91
Total Cost: 1737.56698608
Training Accuracy: 0.952090183185
Validation Accuracy: 0.634146
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 92
Total Cost: 1730.36725616
Training Accuracy: 0.962893377172
Validation Accuracy: 0.669794
-----------------------
Testing Accuracy: 0.486153846154
-----------------------
Epoch 93
Total Cost: 1589.16298676
Training Accuracy: 0.964772193518
Validation Accuracy: 0.636023
-----------------------
Testing Accuracy: 0.461538461538
-----------------------
Epoch 94
Total Cost: 1479.08324242
Training Accuracy: 0.961014560827
Validation Accuracy: 0.645403
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 95
Total Cost: 1591.73714828
Training Accuracy: 0.970878346642
Validation Accuracy: 0.630394
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 96
Total Cost: 1403.55857658
Training Accuracy: 0.963363081259
Validation Accuracy: 0.63227
-----------------------
Testing Accuracy: 0.489230769231
-----------------------
Epoch 97
Total Cost: 1765.49157715
Training Accuracy: 0.939408172851
Validation Accuracy: 0.592871
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 98
Total Cost: 1879.23581314
Training Accuracy: 0.941756693283
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 99
Total Cost: 1710.0288887
Training Accuracy: 0.970408642555
Validation Accuracy: 0.626642
-----------------------
Testing Accuracy: 0.461538461538
-----------------------
Epoch 100
Total Cost: 1453.64546967
Training Accuracy: 0.965711601691
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.48
50, 0.2, ,
Using TensorFlow backend.
/mnt/data1/Develop/MemN2N/My/memn2n/mc_data_utils.py:172: VisibleDeprecationWarning: using a non-integer number instead of an integer will result in an error in the future
  lb[label] = 1
Started Task: 1
Load trainng data from ./data/traintest/train/mc160.train.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade2.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade2.test.0.1.json
CorrectAnswer not in 'ABC'
{u'text': u'What is compared and contrasted in the passage? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'New York City and Chicago', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'international camps and sports camps', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'weather in different parts of the world', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'The climate of Ghana is warm all year. The climate of New York City is sometimes cold. What can be concluded from this information? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'All parts of the world have the same climate.', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'Different parts of the world can have different climates.', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'The climate of New York City and the climate of England are alike.', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'Why might Ilsa like to eat ice cream in the summer? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'Ilsa likes eating something cold when the weather is hot.', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'Ilsa likes eating something warm when the weather is hot.', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'Ilsa likes eating something hot when the weather is cold.', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'What is a main idea of the story? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'eating stew in Senegal', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'visiting Argentina in the summer', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'weather around the world', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'Read these sentences: "Ilsa was excited to meet her camp counselor Itzel when she arrived for her first day at The International Camp in Forest Hills, Queens, in New York City. Itzel asked the campers to sit in a circle, introduce themselves, and share which countries their families were from." What does the word "international" mean? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'having to do with more than one country', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'having to do with being outdoors', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'having to do with playing baseball or soccer', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
Load trainng data from ./data/traintest/train/readworks_grade2.dev.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade3.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade1.test.0.1.json
Load trainng data from ./data/traintest/train/readworks_gradek.0.1.json
Load trainng data from ./data/traintest/train/mc160.dev.0.1.json
Load testing data from ./data/traintest/test/readworks_grade1.dev.0.1.json
('use pickle', 1)
Longest sentence length 128
Longest story length 171
Answer length 60
Label size 4
Training set shape (2129, 100, 128)
Training Size 2129
Validation Size 533
Testing Size 325
('q_emb', <tf.Tensor 'MemN2N2/embedding_lookup:0' shape=(?, 128, 50) dtype=float32>)
('self._encoding', <tf.Tensor 'encoding:0' shape=(128, 50) dtype=float32>)
('u_0', <tf.Tensor 'MemN2N2/Sum:0' shape=(?, 50) dtype=float32>)
('as_emb', <tf.Tensor 'MemN2N2/embedding_lookup_7:0' shape=(?, 4, 60, 50) dtype=float32>)
('self._answer_encoding', <tf.Tensor 'answer_encoding:0' shape=(60, 50) dtype=float32>)
('as_enc', <tf.Tensor 'MemN2N2/Sum_13:0' shape=(?, 4, 50) dtype=float32>)
('u_k', <tf.Tensor 'MemN2N2/Relu_2:0' shape=(?, 50) dtype=float32>)
('u_k_l', <tf.Tensor 'MemN2N2/Reshape:0' shape=(?, 4, 50) dtype=float32>)
('as_ans', <tf.Tensor 'MemN2N2/Sub:0' shape=(?, 4, 50) dtype=float32>)
('as_ans', <tf.Tensor 'MemN2N2/Sum_14:0' shape=(?, 4) dtype=float32>)
('logits', <tf.Tensor 'MemN2N2/Sum_14:0' shape=(?, 4) dtype=float32>)
-----------------------
Epoch 1
Total Cost: 880827.132812
Training Accuracy: 0.418976045092
Validation Accuracy: 0.348968
-----------------------
Testing Accuracy: 0.366153846154
-----------------------
Epoch 2
Total Cost: 507019.150391
Training Accuracy: 0.537341474871
Validation Accuracy: 0.378987
-----------------------
Testing Accuracy: 0.353846153846
-----------------------
Epoch 3
Total Cost: 338031.577637
Training Accuracy: 0.722404884922
Validation Accuracy: 0.467167
-----------------------
Testing Accuracy: 0.393846153846
-----------------------
Epoch 4
Total Cost: 226597.335449
Training Accuracy: 0.784405824331
Validation Accuracy: 0.487805
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 5
Total Cost: 148096.671875
Training Accuracy: 0.782527007985
Validation Accuracy: 0.508443
-----------------------
Testing Accuracy: 0.4
-----------------------
Epoch 6
Total Cost: 108153.288818
Training Accuracy: 0.816815406294
Validation Accuracy: 0.527205
-----------------------
Testing Accuracy: 0.403076923077
-----------------------
Epoch 7
Total Cost: 81915.3469238
Training Accuracy: 0.802254579615
Validation Accuracy: 0.515947
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 8
Total Cost: 67808.7270508
Training Accuracy: 0.854861437295
Validation Accuracy: 0.540338
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 9
Total Cost: 55666.3774414
Training Accuracy: 0.859558478159
Validation Accuracy: 0.5197
-----------------------
Testing Accuracy: 0.406153846154
-----------------------
Epoch 10
Total Cost: 49530.2019043
Training Accuracy: 0.865194927196
Validation Accuracy: 0.572233
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 11
Total Cost: 40925.2915039
Training Accuracy: 0.896665100986
Validation Accuracy: 0.58349
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 12
Total Cost: 31479.1031494
Training Accuracy: 0.875058713011
Validation Accuracy: 0.545966
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 13
Total Cost: 28218.6710815
Training Accuracy: 0.868013151714
Validation Accuracy: 0.555347
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 14
Total Cost: 25246.6986694
Training Accuracy: 0.869422263974
Validation Accuracy: 0.547842
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 15
Total Cost: 23758.7093506
Training Accuracy: 0.914044152184
Validation Accuracy: 0.549719
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 16
Total Cost: 19273.5097046
Training Accuracy: 0.899953029591
Validation Accuracy: 0.560976
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 17
Total Cost: 15761.0993652
Training Accuracy: 0.892437764209
Validation Accuracy: 0.547842
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 18
Total Cost: 14670.3568726
Training Accuracy: 0.8961953969
Validation Accuracy: 0.553471
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 19
Total Cost: 12761.2886963
Training Accuracy: 0.906059182715
Validation Accuracy: 0.545966
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 20
Total Cost: 10591.5171967
Training Accuracy: 0.898543917332
Validation Accuracy: 0.560976
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 21
Total Cost: 9903.59877014
Training Accuracy: 0.923438233913
Validation Accuracy: 0.560976
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 22
Total Cost: 7718.8586731
Training Accuracy: 0.943165805543
Validation Accuracy: 0.592871
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 23
Total Cost: 6662.56069946
Training Accuracy: 0.908407703147
Validation Accuracy: 0.56848
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 24
Total Cost: 5639.95069885
Training Accuracy: 0.929544387036
Validation Accuracy: 0.594747
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 25
Total Cost: 5388.65783691
Training Accuracy: 0.934711131987
Validation Accuracy: 0.581613
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 26
Total Cost: 4999.67215729
Training Accuracy: 0.934711131987
Validation Accuracy: 0.596623
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 27
Total Cost: 3959.58586884
Training Accuracy: 0.938468764678
Validation Accuracy: 0.58349
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 28
Total Cost: 3620.59893036
Training Accuracy: 0.946453734147
Validation Accuracy: 0.560976
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 29
Total Cost: 3292.05492401
Training Accuracy: 0.930953499295
Validation Accuracy: 0.587242
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 30
Total Cost: 3291.44742584
Training Accuracy: 0.947862846407
Validation Accuracy: 0.604128
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 31
Total Cost: 2827.07524872
Training Accuracy: 0.949741662752
Validation Accuracy: 0.600375
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 32
Total Cost: 2886.85906982
Training Accuracy: 0.971817754814
Validation Accuracy: 0.619137
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 33
Total Cost: 2707.73432159
Training Accuracy: 0.96054485674
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 34
Total Cost: 2462.11765671
Training Accuracy: 0.962893377172
Validation Accuracy: 0.621013
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 35
Total Cost: 2359.51897049
Training Accuracy: 0.967590418037
Validation Accuracy: 0.617261
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 36
Total Cost: 2291.9859314
Training Accuracy: 0.959605448567
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 37
Total Cost: 2155.34358215
Training Accuracy: 0.958196336308
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.464615384615
-----------------------
Epoch 38
Total Cost: 2184.40570831
Training Accuracy: 0.956787224049
Validation Accuracy: 0.600375
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 39
Total Cost: 2026.15003586
Training Accuracy: 0.971817754814
Validation Accuracy: 0.609756
-----------------------
Testing Accuracy: 0.48
-----------------------
Epoch 40
Total Cost: 1903.87867355
Training Accuracy: 0.971817754814
Validation Accuracy: 0.589118
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 41
Total Cost: 1879.85952759
Training Accuracy: 0.95396899953
Validation Accuracy: 0.592871
-----------------------
Testing Accuracy: 0.476923076923
-----------------------
Epoch 42
Total Cost: 1958.90731812
Training Accuracy: 0.965711601691
Validation Accuracy: 0.604128
-----------------------
Testing Accuracy: 0.483076923077
-----------------------
Epoch 43
Total Cost: 1884.36880875
Training Accuracy: 0.960075152654
Validation Accuracy: 0.604128
-----------------------
Testing Accuracy: 0.48
-----------------------
Epoch 44
Total Cost: 2141.62545776
Training Accuracy: 0.973226867074
Validation Accuracy: 0.622889
-----------------------
Testing Accuracy: 0.464615384615
-----------------------
Epoch 45
Total Cost: 1821.13515091
Training Accuracy: 0.974635979333
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 46
Total Cost: 1894.06924438
Training Accuracy: 0.975105683419
Validation Accuracy: 0.622889
-----------------------
Testing Accuracy: 0.476923076923
-----------------------
Epoch 47
Total Cost: 1750.31552887
Training Accuracy: 0.979333020197
Validation Accuracy: 0.600375
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 48
Total Cost: 1504.43478775
Training Accuracy: 0.980742132457
Validation Accuracy: 0.609756
-----------------------
Testing Accuracy: 0.476923076923
-----------------------
Epoch 49
Total Cost: 1636.11432266
Training Accuracy: 0.965241897605
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.486153846154
-----------------------
Epoch 50
Total Cost: 1790.76098251
Training Accuracy: 0.970878346642
Validation Accuracy: 0.590994
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 51
Total Cost: 1695.35005188
Training Accuracy: 0.973226867074
Validation Accuracy: 0.594747
-----------------------
Testing Accuracy: 0.504615384615
-----------------------
Epoch 52
Total Cost: 1564.08996201
Training Accuracy: 0.972287458901
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.495384615385
-----------------------
Epoch 53
Total Cost: 1696.05442429
Training Accuracy: 0.966651009864
Validation Accuracy: 0.602251
-----------------------
Testing Accuracy: 0.464615384615
-----------------------
Epoch 54
Total Cost: 1699.44391632
Training Accuracy: 0.967590418037
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.461538461538
-----------------------
Epoch 55
Total Cost: 1728.87932587
Training Accuracy: 0.976514795679
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 56
Total Cost: 1513.22099686
Training Accuracy: 0.977923907938
Validation Accuracy: 0.587242
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 57
Total Cost: 1606.86423492
Training Accuracy: 0.969469234382
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.48
-----------------------
Epoch 58
Total Cost: 1545.60070801
Training Accuracy: 0.976984499765
Validation Accuracy: 0.594747
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 59
Total Cost: 1575.53060913
Training Accuracy: 0.976984499765
Validation Accuracy: 0.621013
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 60
Total Cost: 1681.01516342
Training Accuracy: 0.979333020197
Validation Accuracy: 0.596623
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 61
Total Cost: 1456.50855255
Training Accuracy: 0.974166275247
Validation Accuracy: 0.626642
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 62
Total Cost: 1478.3152504
Training Accuracy: 0.976514795679
Validation Accuracy: 0.609756
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 63
Total Cost: 1517.31461334
Training Accuracy: 0.970408642555
Validation Accuracy: 0.596623
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 64
Total Cost: 1599.29623795
Training Accuracy: 0.974635979333
Validation Accuracy: 0.594747
-----------------------
Testing Accuracy: 0.476923076923
-----------------------
Epoch 65
Total Cost: 1607.8737793
Training Accuracy: 0.981681540629
Validation Accuracy: 0.590994
-----------------------
Testing Accuracy: 0.504615384615
-----------------------
Epoch 66
Total Cost: 1567.32575607
Training Accuracy: 0.968060122123
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.489230769231
-----------------------
Epoch 67
Total Cost: 1611.57550812
Training Accuracy: 0.981681540629
Validation Accuracy: 0.596623
-----------------------
Testing Accuracy: 0.464615384615
-----------------------
Epoch 68
Total Cost: 1424.91307831
Training Accuracy: 0.984030061062
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.489230769231
-----------------------
Epoch 69
Total Cost: 1432.90932846
Training Accuracy: 0.972757162987
Validation Accuracy: 0.613508
-----------------------
Testing Accuracy: 0.48
-----------------------
Epoch 70
Total Cost: 1443.24769592
Training Accuracy: 0.980742132457
Validation Accuracy: 0.622889
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 71
Total Cost: 1578.3904686
Training Accuracy: 0.982620948802
Validation Accuracy: 0.596623
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 72
Total Cost: 1381.39453125
Training Accuracy: 0.98684828558
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 73
Total Cost: 1249.18671608
Training Accuracy: 0.963363081259
Validation Accuracy: 0.589118
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 74
Total Cost: 1654.60306168
Training Accuracy: 0.974635979333
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.476923076923
-----------------------
Epoch 75
Total Cost: 1618.81938171
Training Accuracy: 0.985439173321
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.492307692308
-----------------------
Epoch 76
Total Cost: 1545.70313644
Training Accuracy: 0.979333020197
Validation Accuracy: 0.592871
-----------------------
Testing Accuracy: 0.48
-----------------------
Epoch 77
Total Cost: 1517.18365097
Training Accuracy: 0.982620948802
Validation Accuracy: 0.592871
-----------------------
Testing Accuracy: 0.498461538462
-----------------------
Epoch 78
Total Cost: 1737.01481247
Training Accuracy: 0.986378581494
Validation Accuracy: 0.596623
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 79
Total Cost: 1433.03034592
Training Accuracy: 0.979333020197
Validation Accuracy: 0.592871
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 80
Total Cost: 1664.55516434
Training Accuracy: 0.984969469234
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.483076923077
-----------------------
Epoch 81
Total Cost: 1434.58699799
Training Accuracy: 0.984030061062
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.461538461538
-----------------------
Epoch 82
Total Cost: 1340.11141968
Training Accuracy: 0.983090652889
Validation Accuracy: 0.589118
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 83
Total Cost: 1475.00130463
Training Accuracy: 0.977454203852
Validation Accuracy: 0.590994
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 84
Total Cost: 1526.01884842
Training Accuracy: 0.977923907938
Validation Accuracy: 0.58349
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 85
Total Cost: 1786.47179794
Training Accuracy: 0.972287458901
Validation Accuracy: 0.557223
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 86
Total Cost: 1560.54344559
Training Accuracy: 0.984030061062
Validation Accuracy: 0.572233
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 87
Total Cost: 1451.14230347
Training Accuracy: 0.989666510099
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 88
Total Cost: 1264.05776405
Training Accuracy: 0.988727101926
Validation Accuracy: 0.598499
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 89
Total Cost: 1353.15703201
Training Accuracy: 0.977454203852
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 90
Total Cost: 1654.28853989
Training Accuracy: 0.976514795679
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 91
Total Cost: 1556.95550537
Training Accuracy: 0.977454203852
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 92
Total Cost: 1318.46687698
Training Accuracy: 0.98684828558
Validation Accuracy: 0.604128
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 93
Total Cost: 1272.15609169
Training Accuracy: 0.979802724284
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 94
Total Cost: 1544.79503632
Training Accuracy: 0.969938938469
Validation Accuracy: 0.598499
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 95
Total Cost: 1499.27954483
Training Accuracy: 0.97369657116
Validation Accuracy: 0.585366
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 96
Total Cost: 1377.92586136
Training Accuracy: 0.990605918271
Validation Accuracy: 0.604128
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 97
Total Cost: 1226.24403763
Training Accuracy: 0.983090652889
Validation Accuracy: 0.600375
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 98
Total Cost: 1286.07049561
Training Accuracy: 0.985908877407
Validation Accuracy: 0.613508
-----------------------
Testing Accuracy: 0.461538461538
-----------------------
Epoch 99
Total Cost: 1260.50993347
Training Accuracy: 0.991545326444
Validation Accuracy: 0.619137
-----------------------
Testing Accuracy: 0.48
-----------------------
Epoch 100
Total Cost: 1103.04864311
Training Accuracy: 0.980742132457
Validation Accuracy: 0.613508
-----------------------
Testing Accuracy: 0.492307692308
50, 0.1, ,
Using TensorFlow backend.
/mnt/data1/Develop/MemN2N/My/memn2n/mc_data_utils.py:172: VisibleDeprecationWarning: using a non-integer number instead of an integer will result in an error in the future
  lb[label] = 1
Started Task: 1
Load trainng data from ./data/traintest/train/mc160.train.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade2.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade2.test.0.1.json
CorrectAnswer not in 'ABC'
{u'text': u'What is compared and contrasted in the passage? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'New York City and Chicago', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'international camps and sports camps', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'weather in different parts of the world', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'The climate of Ghana is warm all year. The climate of New York City is sometimes cold. What can be concluded from this information? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'All parts of the world have the same climate.', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'Different parts of the world can have different climates.', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'The climate of New York City and the climate of England are alike.', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'Why might Ilsa like to eat ice cream in the summer? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'Ilsa likes eating something cold when the weather is hot.', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'Ilsa likes eating something warm when the weather is hot.', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'Ilsa likes eating something hot when the weather is cold.', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'What is a main idea of the story? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'eating stew in Senegal', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'visiting Argentina in the summer', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'weather around the world', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'Read these sentences: "Ilsa was excited to meet her camp counselor Itzel when she arrived for her first day at The International Camp in Forest Hills, Queens, in New York City. Itzel asked the campers to sit in a circle, introduce themselves, and share which countries their families were from." What does the word "international" mean? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'having to do with more than one country', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'having to do with being outdoors', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'having to do with playing baseball or soccer', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
Load trainng data from ./data/traintest/train/readworks_grade2.dev.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade3.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade1.test.0.1.json
Load trainng data from ./data/traintest/train/readworks_gradek.0.1.json
Load trainng data from ./data/traintest/train/mc160.dev.0.1.json
Load testing data from ./data/traintest/test/readworks_grade1.dev.0.1.json
('use pickle', 1)
Longest sentence length 128
Longest story length 171
Answer length 60
Label size 4
Training set shape (2129, 100, 128)
Training Size 2129
Validation Size 533
Testing Size 325
('q_emb', <tf.Tensor 'MemN2N2/embedding_lookup:0' shape=(?, 128, 50) dtype=float32>)
('self._encoding', <tf.Tensor 'encoding:0' shape=(128, 50) dtype=float32>)
('u_0', <tf.Tensor 'MemN2N2/Sum:0' shape=(?, 50) dtype=float32>)
('as_emb', <tf.Tensor 'MemN2N2/embedding_lookup_7:0' shape=(?, 4, 60, 50) dtype=float32>)
('self._answer_encoding', <tf.Tensor 'answer_encoding:0' shape=(60, 50) dtype=float32>)
('as_enc', <tf.Tensor 'MemN2N2/Sum_13:0' shape=(?, 4, 50) dtype=float32>)
('u_k', <tf.Tensor 'MemN2N2/Relu_2:0' shape=(?, 50) dtype=float32>)
('u_k_l', <tf.Tensor 'MemN2N2/Reshape:0' shape=(?, 4, 50) dtype=float32>)
('as_ans', <tf.Tensor 'MemN2N2/Sub:0' shape=(?, 4, 50) dtype=float32>)
('as_ans', <tf.Tensor 'MemN2N2/Sum_14:0' shape=(?, 4) dtype=float32>)
('logits', <tf.Tensor 'MemN2N2/Sum_14:0' shape=(?, 4) dtype=float32>)
-----------------------
Epoch 1
Total Cost: 556741.068359
Training Accuracy: 0.438703616721
Validation Accuracy: 0.365854
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 2
Total Cost: 311301.716309
Training Accuracy: 0.602160638798
Validation Accuracy: 0.410882
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 3
Total Cost: 201579.881348
Training Accuracy: 0.687646782527
Validation Accuracy: 0.482176
-----------------------
Testing Accuracy: 0.406153846154
-----------------------
Epoch 4
Total Cost: 141293.846436
Training Accuracy: 0.744480976984
Validation Accuracy: 0.467167
-----------------------
Testing Accuracy: 0.381538461538
-----------------------
Epoch 5
Total Cost: 102979.115234
Training Accuracy: 0.800845467356
Validation Accuracy: 0.512195
-----------------------
Testing Accuracy: 0.403076923077
-----------------------
Epoch 6
Total Cost: 74380.6115723
Training Accuracy: 0.853922029122
Validation Accuracy: 0.54409
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 7
Total Cost: 58693.4001465
Training Accuracy: 0.866134335369
Validation Accuracy: 0.572233
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 8
Total Cost: 45653.2242432
Training Accuracy: 0.870361672147
Validation Accuracy: 0.540338
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 9
Total Cost: 40597.9730835
Training Accuracy: 0.872240488492
Validation Accuracy: 0.579737
-----------------------
Testing Accuracy: 0.406153846154
-----------------------
Epoch 10
Total Cost: 35331.9648438
Training Accuracy: 0.900892437764
Validation Accuracy: 0.579737
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 11
Total Cost: 30122.6204224
Training Accuracy: 0.865194927196
Validation Accuracy: 0.549719
-----------------------
Testing Accuracy: 0.412307692308
-----------------------
Epoch 12
Total Cost: 29544.8394165
Training Accuracy: 0.886801315171
Validation Accuracy: 0.577861
-----------------------
Testing Accuracy: 0.403076923077
-----------------------
Epoch 13
Total Cost: 25837.0304565
Training Accuracy: 0.810709253171
Validation Accuracy: 0.542214
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 14
Total Cost: 23160.2557373
Training Accuracy: 0.913574448098
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.403076923077
-----------------------
Epoch 15
Total Cost: 22987.8745728
Training Accuracy: 0.920150305308
Validation Accuracy: 0.594747
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 16
Total Cost: 19132.0126953
Training Accuracy: 0.92907468295
Validation Accuracy: 0.596623
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 17
Total Cost: 18648.7883606
Training Accuracy: 0.903240958196
Validation Accuracy: 0.574109
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 18
Total Cost: 17205.4423828
Training Accuracy: 0.939877876938
Validation Accuracy: 0.598499
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 19
Total Cost: 15695.5138855
Training Accuracy: 0.916392672616
Validation Accuracy: 0.587242
-----------------------
Testing Accuracy: 0.4
-----------------------
Epoch 20
Total Cost: 13625.5274048
Training Accuracy: 0.908407703147
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 21
Total Cost: 12995.1260071
Training Accuracy: 0.887271019258
Validation Accuracy: 0.596623
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 22
Total Cost: 12701.4444275
Training Accuracy: 0.933302019728
Validation Accuracy: 0.609756
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 23
Total Cost: 12793.0049133
Training Accuracy: 0.911695631752
Validation Accuracy: 0.602251
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 24
Total Cost: 10743.831543
Training Accuracy: 0.91592296853
Validation Accuracy: 0.615385
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 25
Total Cost: 10275.5906372
Training Accuracy: 0.936589948333
Validation Accuracy: 0.617261
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 26
Total Cost: 9560.20140076
Training Accuracy: 0.953029591357
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 27
Total Cost: 8090.03178406
Training Accuracy: 0.941756693283
Validation Accuracy: 0.628518
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 28
Total Cost: 7731.52642822
Training Accuracy: 0.922968529826
Validation Accuracy: 0.617261
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 29
Total Cost: 7553.77854919
Training Accuracy: 0.966181305777
Validation Accuracy: 0.621013
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 30
Total Cost: 7029.69851685
Training Accuracy: 0.949271958666
Validation Accuracy: 0.628518
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 31
Total Cost: 6386.157547
Training Accuracy: 0.953029591357
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 32
Total Cost: 5789.53315735
Training Accuracy: 0.912635039925
Validation Accuracy: 0.615385
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 33
Total Cost: 5835.58312988
Training Accuracy: 0.953029591357
Validation Accuracy: 0.619137
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 34
Total Cost: 5751.12342834
Training Accuracy: 0.9342414279
Validation Accuracy: 0.602251
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 35
Total Cost: 4685.53996277
Training Accuracy: 0.951150775012
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 36
Total Cost: 4833.83263397
Training Accuracy: 0.957726632222
Validation Accuracy: 0.622889
-----------------------
Testing Accuracy: 0.412307692308
-----------------------
Epoch 37
Total Cost: 4773.49855042
Training Accuracy: 0.947862846407
Validation Accuracy: 0.626642
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 38
Total Cost: 4069.19091034
Training Accuracy: 0.953499295444
Validation Accuracy: 0.615385
-----------------------
Testing Accuracy: 0.406153846154
-----------------------
Epoch 39
Total Cost: 4213.88521576
Training Accuracy: 0.952090183185
Validation Accuracy: 0.598499
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 40
Total Cost: 3990.77014923
Training Accuracy: 0.956787224049
Validation Accuracy: 0.600375
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 41
Total Cost: 3500.46644592
Training Accuracy: 0.951150775012
Validation Accuracy: 0.604128
-----------------------
Testing Accuracy: 0.412307692308
-----------------------
Epoch 42
Total Cost: 3446.02957153
Training Accuracy: 0.962423673086
Validation Accuracy: 0.596623
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 43
Total Cost: 3016.49233246
Training Accuracy: 0.965711601691
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 44
Total Cost: 2790.30306244
Training Accuracy: 0.969469234382
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 45
Total Cost: 2695.96709442
Training Accuracy: 0.973226867074
Validation Accuracy: 0.600375
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 46
Total Cost: 2646.09319305
Training Accuracy: 0.961484264913
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 47
Total Cost: 2899.81018829
Training Accuracy: 0.937059652419
Validation Accuracy: 0.589118
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 48
Total Cost: 2659.13615417
Training Accuracy: 0.963363081259
Validation Accuracy: 0.621013
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 49
Total Cost: 2715.96833801
Training Accuracy: 0.957256928135
Validation Accuracy: 0.598499
-----------------------
Testing Accuracy: 0.412307692308
-----------------------
Epoch 50
Total Cost: 2485.86086273
Training Accuracy: 0.96054485674
Validation Accuracy: 0.600375
-----------------------
Testing Accuracy: 0.381538461538
-----------------------
Epoch 51
Total Cost: 2194.61878204
Training Accuracy: 0.962893377172
Validation Accuracy: 0.566604
-----------------------
Testing Accuracy: 0.390769230769
-----------------------
Epoch 52
Total Cost: 2149.92492676
Training Accuracy: 0.945044621888
Validation Accuracy: 0.587242
-----------------------
Testing Accuracy: 0.406153846154
-----------------------
Epoch 53
Total Cost: 2190.53110123
Training Accuracy: 0.969938938469
Validation Accuracy: 0.602251
-----------------------
Testing Accuracy: 0.406153846154
-----------------------
Epoch 54
Total Cost: 2044.93827057
Training Accuracy: 0.972757162987
Validation Accuracy: 0.602251
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 55
Total Cost: 1964.61956787
Training Accuracy: 0.971817754814
Validation Accuracy: 0.58349
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 56
Total Cost: 2177.01247025
Training Accuracy: 0.972757162987
Validation Accuracy: 0.585366
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 57
Total Cost: 1865.60856247
Training Accuracy: 0.976045091592
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.393846153846
-----------------------
Epoch 58
Total Cost: 1727.80453873
Training Accuracy: 0.973226867074
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.363076923077
-----------------------
Epoch 59
Total Cost: 1766.33976746
Training Accuracy: 0.978863316111
Validation Accuracy: 0.594747
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 60
Total Cost: 1671.73360062
Training Accuracy: 0.963832785345
Validation Accuracy: 0.626642
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 61
Total Cost: 1812.38605118
Training Accuracy: 0.988727101926
Validation Accuracy: 0.617261
-----------------------
Testing Accuracy: 0.393846153846
-----------------------
Epoch 62
Total Cost: 1536.49150085
Training Accuracy: 0.986378581494
Validation Accuracy: 0.622889
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 63
Total Cost: 1548.98868179
Training Accuracy: 0.968999530296
Validation Accuracy: 0.619137
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 64
Total Cost: 1695.30163574
Training Accuracy: 0.967590418037
Validation Accuracy: 0.594747
-----------------------
Testing Accuracy: 0.403076923077
-----------------------
Epoch 65
Total Cost: 1560.01636887
Training Accuracy: 0.973226867074
Validation Accuracy: 0.615385
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 66
Total Cost: 1511.7382164
Training Accuracy: 0.986378581494
Validation Accuracy: 0.613508
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 67
Total Cost: 1352.87682343
Training Accuracy: 0.976045091592
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 68
Total Cost: 1447.46257401
Training Accuracy: 0.983090652889
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 69
Total Cost: 1375.90582275
Training Accuracy: 0.975575387506
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.381538461538
-----------------------
Epoch 70
Total Cost: 1635.80263519
Training Accuracy: 0.974166275247
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 71
Total Cost: 1791.37970734
Training Accuracy: 0.978393612024
Validation Accuracy: 0.589118
-----------------------
Testing Accuracy: 0.378461538462
-----------------------
Epoch 72
Total Cost: 1472.34936905
Training Accuracy: 0.984499765148
Validation Accuracy: 0.600375
-----------------------
Testing Accuracy: 0.384615384615
-----------------------
Epoch 73
Total Cost: 1294.86710739
Training Accuracy: 0.977454203852
Validation Accuracy: 0.622889
-----------------------
Testing Accuracy: 0.344615384615
-----------------------
Epoch 74
Total Cost: 1560.7968483
Training Accuracy: 0.985439173321
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 75
Total Cost: 1338.69595718
Training Accuracy: 0.977923907938
Validation Accuracy: 0.60788
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 76
Total Cost: 1391.43332291
Training Accuracy: 0.984030061062
Validation Accuracy: 0.615385
-----------------------
Testing Accuracy: 0.393846153846
-----------------------
Epoch 77
Total Cost: 1404.26603699
Training Accuracy: 0.968060122123
Validation Accuracy: 0.598499
-----------------------
Testing Accuracy: 0.372307692308
-----------------------
Epoch 78
Total Cost: 1584.46809006
Training Accuracy: 0.984499765148
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.393846153846
-----------------------
Epoch 79
Total Cost: 1354.66408348
Training Accuracy: 0.987787693753
Validation Accuracy: 0.626642
-----------------------
Testing Accuracy: 0.390769230769
-----------------------
Epoch 80
Total Cost: 1198.11968803
Training Accuracy: 0.989666510099
Validation Accuracy: 0.626642
-----------------------
Testing Accuracy: 0.387692307692
-----------------------
Epoch 81
Total Cost: 1170.71329117
Training Accuracy: 0.975575387506
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.403076923077
-----------------------
Epoch 82
Total Cost: 1386.53440857
Training Accuracy: 0.984499765148
Validation Accuracy: 0.619137
-----------------------
Testing Accuracy: 0.4
-----------------------
Epoch 83
Total Cost: 1542.77600479
Training Accuracy: 0.987787693753
Validation Accuracy: 0.598499
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 84
Total Cost: 1437.09127808
Training Accuracy: 0.984969469234
Validation Accuracy: 0.637899
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 85
Total Cost: 1281.37384605
Training Accuracy: 0.988257397839
Validation Accuracy: 0.617261
-----------------------
Testing Accuracy: 0.4
-----------------------
Epoch 86
Total Cost: 1152.89697456
Training Accuracy: 0.98027242837
Validation Accuracy: 0.604128
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 87
Total Cost: 1270.69905472
Training Accuracy: 0.973226867074
Validation Accuracy: 0.590994
-----------------------
Testing Accuracy: 0.412307692308
-----------------------
Epoch 88
Total Cost: 1652.58470154
Training Accuracy: 0.98684828558
Validation Accuracy: 0.630394
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 89
Total Cost: 1532.2718277
Training Accuracy: 0.983090652889
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 90
Total Cost: 1424.34550476
Training Accuracy: 0.981681540629
Validation Accuracy: 0.604128
-----------------------
Testing Accuracy: 0.387692307692
-----------------------
Epoch 91
Total Cost: 1434.75920105
Training Accuracy: 0.985439173321
Validation Accuracy: 0.609756
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 92
Total Cost: 1275.8274231
Training Accuracy: 0.981681540629
Validation Accuracy: 0.606004
-----------------------
Testing Accuracy: 0.366153846154
-----------------------
Epoch 93
Total Cost: 1342.74064636
Training Accuracy: 0.98684828558
Validation Accuracy: 0.621013
-----------------------
Testing Accuracy: 0.378461538462
-----------------------
Epoch 94
Total Cost: 1363.60224342
Training Accuracy: 0.98684828558
Validation Accuracy: 0.626642
-----------------------
Testing Accuracy: 0.393846153846
-----------------------
Epoch 95
Total Cost: 1326.19765282
Training Accuracy: 0.990605918271
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.381538461538
-----------------------
Epoch 96
Total Cost: 1220.91300392
Training Accuracy: 0.969938938469
Validation Accuracy: 0.609756
-----------------------
Testing Accuracy: 0.372307692308
-----------------------
Epoch 97
Total Cost: 1266.4882431
Training Accuracy: 0.984499765148
Validation Accuracy: 0.622889
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 98
Total Cost: 1200.9519577
Training Accuracy: 0.990136214185
Validation Accuracy: 0.649156
-----------------------
Testing Accuracy: 0.406153846154
-----------------------
Epoch 99
Total Cost: 1206.73348618
Training Accuracy: 0.985908877407
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.378461538462
-----------------------
Epoch 100
Total Cost: 1161.05724525
Training Accuracy: 0.992484734617
Validation Accuracy: 0.63227
-----------------------
Testing Accuracy: 0.418461538462
50, 0.05, ,
Using TensorFlow backend.
/mnt/data1/Develop/MemN2N/My/memn2n/mc_data_utils.py:172: VisibleDeprecationWarning: using a non-integer number instead of an integer will result in an error in the future
  lb[label] = 1
Started Task: 1
Load trainng data from ./data/traintest/train/mc160.train.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade2.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade2.test.0.1.json
CorrectAnswer not in 'ABC'
{u'text': u'What is compared and contrasted in the passage? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'New York City and Chicago', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'international camps and sports camps', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'weather in different parts of the world', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'The climate of Ghana is warm all year. The climate of New York City is sometimes cold. What can be concluded from this information? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'All parts of the world have the same climate.', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'Different parts of the world can have different climates.', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'The climate of New York City and the climate of England are alike.', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'Why might Ilsa like to eat ice cream in the summer? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'Ilsa likes eating something cold when the weather is hot.', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'Ilsa likes eating something warm when the weather is hot.', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'Ilsa likes eating something hot when the weather is cold.', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'What is a main idea of the story? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'eating stew in Senegal', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'visiting Argentina in the summer', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'weather around the world', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'Read these sentences: "Ilsa was excited to meet her camp counselor Itzel when she arrived for her first day at The International Camp in Forest Hills, Queens, in New York City. Itzel asked the campers to sit in a circle, introduce themselves, and share which countries their families were from." What does the word "international" mean? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'having to do with more than one country', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'having to do with being outdoors', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'having to do with playing baseball or soccer', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
Load trainng data from ./data/traintest/train/readworks_grade2.dev.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade3.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade1.test.0.1.json
Load trainng data from ./data/traintest/train/readworks_gradek.0.1.json
Load trainng data from ./data/traintest/train/mc160.dev.0.1.json
Load testing data from ./data/traintest/test/readworks_grade1.dev.0.1.json
('use pickle', 1)
Longest sentence length 128
Longest story length 171
Answer length 60
Label size 4
Training set shape (2129, 100, 128)
Training Size 2129
Validation Size 533
Testing Size 325
('q_emb', <tf.Tensor 'MemN2N2/embedding_lookup:0' shape=(?, 128, 50) dtype=float32>)
('self._encoding', <tf.Tensor 'encoding:0' shape=(128, 50) dtype=float32>)
('u_0', <tf.Tensor 'MemN2N2/Sum:0' shape=(?, 50) dtype=float32>)
('as_emb', <tf.Tensor 'MemN2N2/embedding_lookup_7:0' shape=(?, 4, 60, 50) dtype=float32>)
('self._answer_encoding', <tf.Tensor 'answer_encoding:0' shape=(60, 50) dtype=float32>)
('as_enc', <tf.Tensor 'MemN2N2/Sum_13:0' shape=(?, 4, 50) dtype=float32>)
('u_k', <tf.Tensor 'MemN2N2/Relu_2:0' shape=(?, 50) dtype=float32>)
('u_k_l', <tf.Tensor 'MemN2N2/Reshape:0' shape=(?, 4, 50) dtype=float32>)
('as_ans', <tf.Tensor 'MemN2N2/Sub:0' shape=(?, 4, 50) dtype=float32>)
('as_ans', <tf.Tensor 'MemN2N2/Sum_14:0' shape=(?, 4) dtype=float32>)
('logits', <tf.Tensor 'MemN2N2/Sum_14:0' shape=(?, 4) dtype=float32>)
-----------------------
Epoch 1
Total Cost: 356407.763672
Training Accuracy: 0.387975575388
Validation Accuracy: 0.348968
-----------------------
Testing Accuracy: 0.366153846154
-----------------------
Epoch 2
Total Cost: 216835.669922
Training Accuracy: 0.448567402536
Validation Accuracy: 0.341463
-----------------------
Testing Accuracy: 0.298461538462
-----------------------
Epoch 3
Total Cost: 147090.522949
Training Accuracy: 0.588069516205
Validation Accuracy: 0.43152
-----------------------
Testing Accuracy: 0.366153846154
-----------------------
Epoch 4
Total Cost: 108644.614502
Training Accuracy: 0.768905589479
Validation Accuracy: 0.536585
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 5
Total Cost: 82002.6170654
Training Accuracy: 0.769844997651
Validation Accuracy: 0.534709
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 6
Total Cost: 65230.5135498
Training Accuracy: 0.837482386097
Validation Accuracy: 0.58349
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 7
Total Cost: 52958.3902588
Training Accuracy: 0.875528417097
Validation Accuracy: 0.617261
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 8
Total Cost: 45012.7568359
Training Accuracy: 0.879286049789
Validation Accuracy: 0.600375
-----------------------
Testing Accuracy: 0.387692307692
-----------------------
Epoch 9
Total Cost: 35238.2371216
Training Accuracy: 0.90277125411
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 10
Total Cost: 29149.6212158
Training Accuracy: 0.924847346172
Validation Accuracy: 0.615385
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 11
Total Cost: 26023.1890259
Training Accuracy: 0.918741193048
Validation Accuracy: 0.622889
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 12
Total Cost: 20750.821167
Training Accuracy: 0.921559417567
Validation Accuracy: 0.628518
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 13
Total Cost: 19139.0953369
Training Accuracy: 0.936589948333
Validation Accuracy: 0.619137
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 14
Total Cost: 16343.2506409
Training Accuracy: 0.943635509629
Validation Accuracy: 0.622889
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 15
Total Cost: 14214.3867493
Training Accuracy: 0.94081728511
Validation Accuracy: 0.639775
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 16
Total Cost: 14104.3059998
Training Accuracy: 0.914044152184
Validation Accuracy: 0.596623
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 17
Total Cost: 12802.8456421
Training Accuracy: 0.952559887271
Validation Accuracy: 0.609756
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 18
Total Cost: 12127.5675659
Training Accuracy: 0.945044621888
Validation Accuracy: 0.617261
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 19
Total Cost: 10870.5845947
Training Accuracy: 0.957256928135
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 20
Total Cost: 9695.52120972
Training Accuracy: 0.961484264913
Validation Accuracy: 0.65666
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 21
Total Cost: 8593.17536926
Training Accuracy: 0.946453734147
Validation Accuracy: 0.628518
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 22
Total Cost: 8306.16879272
Training Accuracy: 0.968060122123
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 23
Total Cost: 7538.10768127
Training Accuracy: 0.949741662752
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 24
Total Cost: 7286.18913269
Training Accuracy: 0.965241897605
Validation Accuracy: 0.637899
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 25
Total Cost: 6667.61044312
Training Accuracy: 0.963832785345
Validation Accuracy: 0.634146
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 26
Total Cost: 5902.71087646
Training Accuracy: 0.964772193518
Validation Accuracy: 0.637899
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 27
Total Cost: 5506.16003418
Training Accuracy: 0.971817754814
Validation Accuracy: 0.649156
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 28
Total Cost: 4988.78907776
Training Accuracy: 0.967590418037
Validation Accuracy: 0.636023
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 29
Total Cost: 5079.14147186
Training Accuracy: 0.944105213715
Validation Accuracy: 0.639775
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 30
Total Cost: 5644.95708466
Training Accuracy: 0.961014560827
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 31
Total Cost: 4612.6656189
Training Accuracy: 0.975575387506
Validation Accuracy: 0.628518
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 32
Total Cost: 4158.38844299
Training Accuracy: 0.968529826209
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 33
Total Cost: 3845.41324615
Training Accuracy: 0.975105683419
Validation Accuracy: 0.634146
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 34
Total Cost: 3555.24788666
Training Accuracy: 0.981211836543
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 35
Total Cost: 3471.93541718
Training Accuracy: 0.968060122123
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 36
Total Cost: 3574.42643738
Training Accuracy: 0.963363081259
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 37
Total Cost: 3451.25243378
Training Accuracy: 0.976514795679
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 38
Total Cost: 3069.34860992
Training Accuracy: 0.972757162987
Validation Accuracy: 0.630394
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 39
Total Cost: 2974.56864929
Training Accuracy: 0.974635979333
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 40
Total Cost: 2705.68691254
Training Accuracy: 0.982151244716
Validation Accuracy: 0.651032
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 41
Total Cost: 2441.55754089
Training Accuracy: 0.981681540629
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 42
Total Cost: 2246.59295654
Training Accuracy: 0.983560356975
Validation Accuracy: 0.65666
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 43
Total Cost: 2257.70087051
Training Accuracy: 0.977454203852
Validation Accuracy: 0.652908
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 44
Total Cost: 1997.00074768
Training Accuracy: 0.984030061062
Validation Accuracy: 0.652908
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 45
Total Cost: 1976.18815231
Training Accuracy: 0.984030061062
Validation Accuracy: 0.660413
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 46
Total Cost: 1911.48406601
Training Accuracy: 0.970878346642
Validation Accuracy: 0.628518
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 47
Total Cost: 2155.96035385
Training Accuracy: 0.972757162987
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 48
Total Cost: 1924.13217926
Training Accuracy: 0.968060122123
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 49
Total Cost: 2189.29978943
Training Accuracy: 0.982151244716
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 50
Total Cost: 1708.00374603
Training Accuracy: 0.973226867074
Validation Accuracy: 0.634146
-----------------------
Testing Accuracy: 0.483076923077
-----------------------
Epoch 51
Total Cost: 1820.2030983
Training Accuracy: 0.983090652889
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 52
Total Cost: 1553.93917084
Training Accuracy: 0.983090652889
Validation Accuracy: 0.658537
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 53
Total Cost: 1561.67593765
Training Accuracy: 0.982151244716
Validation Accuracy: 0.662289
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 54
Total Cost: 1616.70431137
Training Accuracy: 0.991545326444
Validation Accuracy: 0.664165
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 55
Total Cost: 1420.17092896
Training Accuracy: 0.991075622358
Validation Accuracy: 0.666041
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 56
Total Cost: 1323.88845634
Training Accuracy: 0.98027242837
Validation Accuracy: 0.645403
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 57
Total Cost: 1532.6703186
Training Accuracy: 0.990605918271
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 58
Total Cost: 1354.78622055
Training Accuracy: 0.984499765148
Validation Accuracy: 0.669794
-----------------------
Testing Accuracy: 0.489230769231
-----------------------
Epoch 59
Total Cost: 1475.0151062
Training Accuracy: 0.976984499765
Validation Accuracy: 0.652908
-----------------------
Testing Accuracy: 0.461538461538
-----------------------
Epoch 60
Total Cost: 1519.32356834
Training Accuracy: 0.983560356975
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 61
Total Cost: 1439.90018082
Training Accuracy: 0.976045091592
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 62
Total Cost: 1341.64567184
Training Accuracy: 0.980742132457
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 63
Total Cost: 1269.57504082
Training Accuracy: 0.984499765148
Validation Accuracy: 0.639775
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 64
Total Cost: 1162.82937431
Training Accuracy: 0.972757162987
Validation Accuracy: 0.645403
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 65
Total Cost: 1208.51634216
Training Accuracy: 0.961484264913
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 66
Total Cost: 1229.55291939
Training Accuracy: 0.981211836543
Validation Accuracy: 0.649156
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 67
Total Cost: 1259.78134155
Training Accuracy: 0.983090652889
Validation Accuracy: 0.652908
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 68
Total Cost: 1125.97943878
Training Accuracy: 0.976514795679
Validation Accuracy: 0.660413
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 69
Total Cost: 1401.50196075
Training Accuracy: 0.984030061062
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 70
Total Cost: 1376.68823624
Training Accuracy: 0.984969469234
Validation Accuracy: 0.630394
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 71
Total Cost: 1336.90090179
Training Accuracy: 0.983560356975
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 72
Total Cost: 1218.22914124
Training Accuracy: 0.981211836543
Validation Accuracy: 0.651032
-----------------------
Testing Accuracy: 0.464615384615
-----------------------
Epoch 73
Total Cost: 1117.77433777
Training Accuracy: 0.977454203852
Validation Accuracy: 0.651032
-----------------------
Testing Accuracy: 0.464615384615
-----------------------
Epoch 74
Total Cost: 1221.74104309
Training Accuracy: 0.988257397839
Validation Accuracy: 0.645403
-----------------------
Testing Accuracy: 0.464615384615
-----------------------
Epoch 75
Total Cost: 1127.89518166
Training Accuracy: 0.98684828558
Validation Accuracy: 0.630394
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 76
Total Cost: 1028.9035511
Training Accuracy: 0.991075622358
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 77
Total Cost: 1039.35798264
Training Accuracy: 0.977454203852
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.486153846154
-----------------------
Epoch 78
Total Cost: 1176.63647461
Training Accuracy: 0.987317989667
Validation Accuracy: 0.664165
-----------------------
Testing Accuracy: 0.492307692308
-----------------------
Epoch 79
Total Cost: 1108.09744072
Training Accuracy: 0.990136214185
Validation Accuracy: 0.664165
-----------------------
Testing Accuracy: 0.476923076923
-----------------------
Epoch 80
Total Cost: 1108.22082329
Training Accuracy: 0.992484734617
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.486153846154
-----------------------
Epoch 81
Total Cost: 986.949451447
Training Accuracy: 0.983560356975
Validation Accuracy: 0.65666
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 82
Total Cost: 957.442150116
Training Accuracy: 0.984499765148
Validation Accuracy: 0.666041
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 83
Total Cost: 912.227067947
Training Accuracy: 0.989196806012
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.48
-----------------------
Epoch 84
Total Cost: 891.69376564
Training Accuracy: 0.984969469234
Validation Accuracy: 0.664165
-----------------------
Testing Accuracy: 0.476923076923
-----------------------
Epoch 85
Total Cost: 1031.9446125
Training Accuracy: 0.969938938469
Validation Accuracy: 0.667917
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 86
Total Cost: 1168.3376503
Training Accuracy: 0.972757162987
Validation Accuracy: 0.636023
-----------------------
Testing Accuracy: 0.476923076923
-----------------------
Epoch 87
Total Cost: 1106.21274376
Training Accuracy: 0.974635979333
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 88
Total Cost: 1120.65144348
Training Accuracy: 0.982620948802
Validation Accuracy: 0.652908
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 89
Total Cost: 1146.45697784
Training Accuracy: 0.98684828558
Validation Accuracy: 0.65666
-----------------------
Testing Accuracy: 0.476923076923
-----------------------
Epoch 90
Total Cost: 939.311388016
Training Accuracy: 0.991075622358
Validation Accuracy: 0.666041
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 91
Total Cost: 820.679443359
Training Accuracy: 0.991545326444
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 92
Total Cost: 820.907546997
Training Accuracy: 0.990136214185
Validation Accuracy: 0.658537
-----------------------
Testing Accuracy: 0.461538461538
-----------------------
Epoch 93
Total Cost: 1038.40037346
Training Accuracy: 0.984969469234
Validation Accuracy: 0.673546
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 94
Total Cost: 1019.6914444
Training Accuracy: 0.977923907938
Validation Accuracy: 0.652908
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 95
Total Cost: 1129.33407593
Training Accuracy: 0.988257397839
Validation Accuracy: 0.664165
-----------------------
Testing Accuracy: 0.492307692308
-----------------------
Epoch 96
Total Cost: 943.564373016
Training Accuracy: 0.983090652889
Validation Accuracy: 0.65666
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 97
Total Cost: 1043.86396027
Training Accuracy: 0.991545326444
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 98
Total Cost: 879.79083252
Training Accuracy: 0.988257397839
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.476923076923
-----------------------
Epoch 99
Total Cost: 899.486625671
Training Accuracy: 0.989666510099
Validation Accuracy: 0.639775
-----------------------
Testing Accuracy: 0.473846153846
-----------------------
Epoch 100
Total Cost: 894.865514755
Training Accuracy: 0.977923907938
Validation Accuracy: 0.621013
-----------------------
Testing Accuracy: 0.430769230769
50, 0.02, ,
Using TensorFlow backend.
/mnt/data1/Develop/MemN2N/My/memn2n/mc_data_utils.py:172: VisibleDeprecationWarning: using a non-integer number instead of an integer will result in an error in the future
  lb[label] = 1
Started Task: 1
Load trainng data from ./data/traintest/train/mc160.train.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade2.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade2.test.0.1.json
CorrectAnswer not in 'ABC'
{u'text': u'What is compared and contrasted in the passage? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'New York City and Chicago', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'international camps and sports camps', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'weather in different parts of the world', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'The climate of Ghana is warm all year. The climate of New York City is sometimes cold. What can be concluded from this information? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'All parts of the world have the same climate.', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'Different parts of the world can have different climates.', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'The climate of New York City and the climate of England are alike.', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'Why might Ilsa like to eat ice cream in the summer? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'Ilsa likes eating something cold when the weather is hot.', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'Ilsa likes eating something warm when the weather is hot.', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'Ilsa likes eating something hot when the weather is cold.', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'What is a main idea of the story? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'eating stew in Senegal', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'visiting Argentina in the summer', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'weather around the world', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'Read these sentences: "Ilsa was excited to meet her camp counselor Itzel when she arrived for her first day at The International Camp in Forest Hills, Queens, in New York City. Itzel asked the campers to sit in a circle, introduce themselves, and share which countries their families were from." What does the word "international" mean? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'having to do with more than one country', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'having to do with being outdoors', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'having to do with playing baseball or soccer', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
Load trainng data from ./data/traintest/train/readworks_grade2.dev.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade3.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade1.test.0.1.json
Load trainng data from ./data/traintest/train/readworks_gradek.0.1.json
Load trainng data from ./data/traintest/train/mc160.dev.0.1.json
Load testing data from ./data/traintest/test/readworks_grade1.dev.0.1.json
('use pickle', 1)
Longest sentence length 128
Longest story length 171
Answer length 60
Label size 4
Training set shape (2129, 100, 128)
Training Size 2129
Validation Size 533
Testing Size 325
('q_emb', <tf.Tensor 'MemN2N2/embedding_lookup:0' shape=(?, 128, 50) dtype=float32>)
('self._encoding', <tf.Tensor 'encoding:0' shape=(128, 50) dtype=float32>)
('u_0', <tf.Tensor 'MemN2N2/Sum:0' shape=(?, 50) dtype=float32>)
('as_emb', <tf.Tensor 'MemN2N2/embedding_lookup_7:0' shape=(?, 4, 60, 50) dtype=float32>)
('self._answer_encoding', <tf.Tensor 'answer_encoding:0' shape=(60, 50) dtype=float32>)
('as_enc', <tf.Tensor 'MemN2N2/Sum_13:0' shape=(?, 4, 50) dtype=float32>)
('u_k', <tf.Tensor 'MemN2N2/Relu_2:0' shape=(?, 50) dtype=float32>)
('u_k_l', <tf.Tensor 'MemN2N2/Reshape:0' shape=(?, 4, 50) dtype=float32>)
('as_ans', <tf.Tensor 'MemN2N2/Sub:0' shape=(?, 4, 50) dtype=float32>)
('as_ans', <tf.Tensor 'MemN2N2/Sum_14:0' shape=(?, 4) dtype=float32>)
('logits', <tf.Tensor 'MemN2N2/Sum_14:0' shape=(?, 4) dtype=float32>)
-----------------------
Epoch 1
Total Cost: 234872.290039
Training Accuracy: 0.333020197276
Validation Accuracy: 0.318949
-----------------------
Testing Accuracy: 0.295384615385
-----------------------
Epoch 2
Total Cost: 139080.746094
Training Accuracy: 0.558008454674
Validation Accuracy: 0.425891
-----------------------
Testing Accuracy: 0.387692307692
-----------------------
Epoch 3
Total Cost: 91004.5817871
Training Accuracy: 0.701268201033
Validation Accuracy: 0.514071
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 4
Total Cost: 63945.1324463
Training Accuracy: 0.763269140442
Validation Accuracy: 0.523452
-----------------------
Testing Accuracy: 0.372307692308
-----------------------
Epoch 5
Total Cost: 49407.5119629
Training Accuracy: 0.864725223109
Validation Accuracy: 0.589118
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 6
Total Cost: 41561.3297119
Training Accuracy: 0.855331141381
Validation Accuracy: 0.572233
-----------------------
Testing Accuracy: 0.393846153846
-----------------------
Epoch 7
Total Cost: 35601.7127686
Training Accuracy: 0.922968529826
Validation Accuracy: 0.613508
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 8
Total Cost: 29274.6835938
Training Accuracy: 0.9342414279
Validation Accuracy: 0.658537
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 9
Total Cost: 23810.3388062
Training Accuracy: 0.942696101456
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 10
Total Cost: 20538.8959961
Training Accuracy: 0.945514325975
Validation Accuracy: 0.637899
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 11
Total Cost: 17937.9598999
Training Accuracy: 0.953029591357
Validation Accuracy: 0.626642
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 12
Total Cost: 14598.3946533
Training Accuracy: 0.904650070456
Validation Accuracy: 0.592871
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 13
Total Cost: 12210.2779541
Training Accuracy: 0.954438703617
Validation Accuracy: 0.628518
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 14
Total Cost: 11682.2216492
Training Accuracy: 0.963363081259
Validation Accuracy: 0.645403
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 15
Total Cost: 9443.21022034
Training Accuracy: 0.963832785345
Validation Accuracy: 0.65666
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 16
Total Cost: 9198.92704773
Training Accuracy: 0.952090183185
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 17
Total Cost: 8396.61810303
Training Accuracy: 0.969469234382
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 18
Total Cost: 7918.61508179
Training Accuracy: 0.95396899953
Validation Accuracy: 0.637899
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 19
Total Cost: 7280.03617859
Training Accuracy: 0.973226867074
Validation Accuracy: 0.651032
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 20
Total Cost: 6893.7300415
Training Accuracy: 0.973226867074
Validation Accuracy: 0.639775
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 21
Total Cost: 6158.93144226
Training Accuracy: 0.975105683419
Validation Accuracy: 0.664165
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 22
Total Cost: 6294.88967896
Training Accuracy: 0.96712071395
Validation Accuracy: 0.622889
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 23
Total Cost: 5212.16534424
Training Accuracy: 0.976514795679
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.461538461538
-----------------------
Epoch 24
Total Cost: 5342.78695679
Training Accuracy: 0.980742132457
Validation Accuracy: 0.636023
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 25
Total Cost: 4641.35562134
Training Accuracy: 0.98027242837
Validation Accuracy: 0.645403
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 26
Total Cost: 4333.93305206
Training Accuracy: 0.95537811179
Validation Accuracy: 0.621013
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 27
Total Cost: 4501.52865601
Training Accuracy: 0.983090652889
Validation Accuracy: 0.634146
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 28
Total Cost: 3762.02925873
Training Accuracy: 0.977454203852
Validation Accuracy: 0.651032
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 29
Total Cost: 3516.76473999
Training Accuracy: 0.972287458901
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 30
Total Cost: 3420.3840332
Training Accuracy: 0.972757162987
Validation Accuracy: 0.615385
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 31
Total Cost: 3220.75894165
Training Accuracy: 0.986378581494
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.461538461538
-----------------------
Epoch 32
Total Cost: 2858.20823669
Training Accuracy: 0.982620948802
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 33
Total Cost: 2866.67266083
Training Accuracy: 0.984969469234
Validation Accuracy: 0.664165
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 34
Total Cost: 2944.56067657
Training Accuracy: 0.970408642555
Validation Accuracy: 0.63227
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 35
Total Cost: 2658.7932663
Training Accuracy: 0.978393612024
Validation Accuracy: 0.645403
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 36
Total Cost: 2437.78143311
Training Accuracy: 0.970408642555
Validation Accuracy: 0.639775
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 37
Total Cost: 2330.89403534
Training Accuracy: 0.967590418037
Validation Accuracy: 0.622889
-----------------------
Testing Accuracy: 0.403076923077
-----------------------
Epoch 38
Total Cost: 2259.10569
Training Accuracy: 0.982151244716
Validation Accuracy: 0.621013
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 39
Total Cost: 2214.54334641
Training Accuracy: 0.98684828558
Validation Accuracy: 0.65666
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 40
Total Cost: 2264.81783676
Training Accuracy: 0.976984499765
Validation Accuracy: 0.621013
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 41
Total Cost: 2179.48950577
Training Accuracy: 0.982151244716
Validation Accuracy: 0.658537
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 42
Total Cost: 2053.57938766
Training Accuracy: 0.987317989667
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 43
Total Cost: 1759.93360519
Training Accuracy: 0.983560356975
Validation Accuracy: 0.651032
-----------------------
Testing Accuracy: 0.44
-----------------------
Epoch 44
Total Cost: 1865.63322449
Training Accuracy: 0.979802724284
Validation Accuracy: 0.634146
-----------------------
Testing Accuracy: 0.470769230769
-----------------------
Epoch 45
Total Cost: 1814.92646027
Training Accuracy: 0.984499765148
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 46
Total Cost: 1748.72932053
Training Accuracy: 0.978863316111
Validation Accuracy: 0.63227
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 47
Total Cost: 1635.90753937
Training Accuracy: 0.984969469234
Validation Accuracy: 0.666041
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 48
Total Cost: 1746.35869598
Training Accuracy: 0.987317989667
Validation Accuracy: 0.628518
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 49
Total Cost: 1601.15895844
Training Accuracy: 0.991545326444
Validation Accuracy: 0.651032
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 50
Total Cost: 1328.42454147
Training Accuracy: 0.988727101926
Validation Accuracy: 0.662289
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 51
Total Cost: 1431.82518768
Training Accuracy: 0.989666510099
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 52
Total Cost: 1244.25786209
Training Accuracy: 0.987787693753
Validation Accuracy: 0.626642
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 53
Total Cost: 1169.26156425
Training Accuracy: 0.992954438704
Validation Accuracy: 0.65666
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 54
Total Cost: 1092.78446579
Training Accuracy: 0.99342414279
Validation Accuracy: 0.652908
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 55
Total Cost: 1065.36236191
Training Accuracy: 0.987787693753
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 56
Total Cost: 1095.82204819
Training Accuracy: 0.985908877407
Validation Accuracy: 0.675422
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 57
Total Cost: 1180.28922081
Training Accuracy: 0.976045091592
Validation Accuracy: 0.637899
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 58
Total Cost: 1199.17056465
Training Accuracy: 0.990136214185
Validation Accuracy: 0.658537
-----------------------
Testing Accuracy: 0.403076923077
-----------------------
Epoch 59
Total Cost: 1106.00489616
Training Accuracy: 0.991075622358
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 60
Total Cost: 972.630067825
Training Accuracy: 0.992015030531
Validation Accuracy: 0.667917
-----------------------
Testing Accuracy: 0.424615384615
-----------------------
Epoch 61
Total Cost: 937.048217773
Training Accuracy: 0.989666510099
Validation Accuracy: 0.65666
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 62
Total Cost: 1059.43077469
Training Accuracy: 0.983560356975
Validation Accuracy: 0.639775
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 63
Total Cost: 1188.84830856
Training Accuracy: 0.985439173321
Validation Accuracy: 0.660413
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 64
Total Cost: 1100.45809937
Training Accuracy: 0.990136214185
Validation Accuracy: 0.662289
-----------------------
Testing Accuracy: 0.406153846154
-----------------------
Epoch 65
Total Cost: 1064.05245209
Training Accuracy: 0.994363550963
Validation Accuracy: 0.677298
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 66
Total Cost: 833.994544983
Training Accuracy: 0.989666510099
Validation Accuracy: 0.675422
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 67
Total Cost: 793.994165421
Training Accuracy: 0.988727101926
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 68
Total Cost: 944.970731735
Training Accuracy: 0.98684828558
Validation Accuracy: 0.651032
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 69
Total Cost: 1058.42124557
Training Accuracy: 0.989196806012
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 70
Total Cost: 973.054096222
Training Accuracy: 0.992484734617
Validation Accuracy: 0.666041
-----------------------
Testing Accuracy: 0.415384615385
-----------------------
Epoch 71
Total Cost: 869.449796677
Training Accuracy: 0.988727101926
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 72
Total Cost: 909.068145752
Training Accuracy: 0.985908877407
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 73
Total Cost: 914.001609802
Training Accuracy: 0.985439173321
Validation Accuracy: 0.664165
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 74
Total Cost: 798.276779175
Training Accuracy: 0.987787693753
Validation Accuracy: 0.666041
-----------------------
Testing Accuracy: 0.387692307692
-----------------------
Epoch 75
Total Cost: 852.896608353
Training Accuracy: 0.975575387506
Validation Accuracy: 0.649156
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 76
Total Cost: 1102.72632027
Training Accuracy: 0.991545326444
Validation Accuracy: 0.667917
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 77
Total Cost: 989.768400192
Training Accuracy: 0.982151244716
Validation Accuracy: 0.662289
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 78
Total Cost: 944.979764938
Training Accuracy: 0.989196806012
Validation Accuracy: 0.639775
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 79
Total Cost: 914.309448242
Training Accuracy: 0.994833255049
Validation Accuracy: 0.651032
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 80
Total Cost: 775.706407547
Training Accuracy: 0.992484734617
Validation Accuracy: 0.658537
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 81
Total Cost: 896.471261978
Training Accuracy: 0.991075622358
Validation Accuracy: 0.652908
-----------------------
Testing Accuracy: 0.393846153846
-----------------------
Epoch 82
Total Cost: 962.265878677
Training Accuracy: 0.994833255049
Validation Accuracy: 0.652908
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 83
Total Cost: 736.574609756
Training Accuracy: 0.996242367309
Validation Accuracy: 0.652908
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 84
Total Cost: 685.317033768
Training Accuracy: 0.993893846876
Validation Accuracy: 0.660413
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 85
Total Cost: 843.735029221
Training Accuracy: 0.987787693753
Validation Accuracy: 0.652908
-----------------------
Testing Accuracy: 0.421538461538
-----------------------
Epoch 86
Total Cost: 919.56554985
Training Accuracy: 0.990136214185
Validation Accuracy: 0.651032
-----------------------
Testing Accuracy: 0.393846153846
-----------------------
Epoch 87
Total Cost: 838.303255081
Training Accuracy: 0.989196806012
Validation Accuracy: 0.639775
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 88
Total Cost: 875.621431351
Training Accuracy: 0.989666510099
Validation Accuracy: 0.630394
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 89
Total Cost: 781.259729385
Training Accuracy: 0.990605918271
Validation Accuracy: 0.654784
-----------------------
Testing Accuracy: 0.427692307692
-----------------------
Epoch 90
Total Cost: 858.028381348
Training Accuracy: 0.994363550963
Validation Accuracy: 0.645403
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 91
Total Cost: 796.676399231
Training Accuracy: 0.996242367309
Validation Accuracy: 0.651032
-----------------------
Testing Accuracy: 0.455384615385
-----------------------
Epoch 92
Total Cost: 705.102092743
Training Accuracy: 0.991075622358
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 93
Total Cost: 780.181779861
Training Accuracy: 0.990605918271
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 94
Total Cost: 736.428113937
Training Accuracy: 0.993893846876
Validation Accuracy: 0.65666
-----------------------
Testing Accuracy: 0.443076923077
-----------------------
Epoch 95
Total Cost: 677.826745987
Training Accuracy: 0.983090652889
Validation Accuracy: 0.637899
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 96
Total Cost: 695.771448135
Training Accuracy: 0.995302959136
Validation Accuracy: 0.64728
-----------------------
Testing Accuracy: 0.412307692308
-----------------------
Epoch 97
Total Cost: 591.833907127
Training Accuracy: 0.996712071395
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 98
Total Cost: 706.891102791
Training Accuracy: 0.986378581494
Validation Accuracy: 0.643527
-----------------------
Testing Accuracy: 0.403076923077
-----------------------
Epoch 99
Total Cost: 848.027647018
Training Accuracy: 0.985908877407
Validation Accuracy: 0.63227
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 100
Total Cost: 919.11857605
Training Accuracy: 0.995302959136
Validation Accuracy: 0.636023
-----------------------
Testing Accuracy: 0.436923076923
50, 0.01, ,
Using TensorFlow backend.
/mnt/data1/Develop/MemN2N/My/memn2n/mc_data_utils.py:172: VisibleDeprecationWarning: using a non-integer number instead of an integer will result in an error in the future
  lb[label] = 1
Started Task: 1
Load trainng data from ./data/traintest/train/mc160.train.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade2.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade2.test.0.1.json
CorrectAnswer not in 'ABC'
{u'text': u'What is compared and contrasted in the passage? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'New York City and Chicago', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'international camps and sports camps', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'weather in different parts of the world', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'The climate of Ghana is warm all year. The climate of New York City is sometimes cold. What can be concluded from this information? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'All parts of the world have the same climate.', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'Different parts of the world can have different climates.', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'The climate of New York City and the climate of England are alike.', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'Why might Ilsa like to eat ice cream in the summer? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'Ilsa likes eating something cold when the weather is hot.', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'Ilsa likes eating something warm when the weather is hot.', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'Ilsa likes eating something hot when the weather is cold.', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'What is a main idea of the story? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'eating stew in Senegal', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'visiting Argentina in the summer', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'weather around the world', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
CorrectAnswer not in 'ABC'
{u'text': u'Read these sentences: "Ilsa was excited to meet her camp counselor Itzel when she arrived for her first day at The International Camp in Forest Hills, Queens, in New York City. Itzel asked the campers to sit in a circle, introduce themselves, and share which countries their families were from." What does the word "international" mean? ', u'correctAnswer': u'', u'answerChoices': [{u'text': u'having to do with more than one country', u'featureValueMap': {}, u'passageList': [], u'label': u'A'}, {u'text': u'having to do with being outdoors', u'featureValueMap': {}, u'passageList': [], u'label': u'B'}, {u'text': u'having to do with playing baseball or soccer', u'featureValueMap': {}, u'passageList': [], u'label': u'C'}]}
Load trainng data from ./data/traintest/train/readworks_grade2.dev.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade3.0.1.json
Load trainng data from ./data/traintest/train/readworks_grade1.test.0.1.json
Load trainng data from ./data/traintest/train/readworks_gradek.0.1.json
Load trainng data from ./data/traintest/train/mc160.dev.0.1.json
Load testing data from ./data/traintest/test/readworks_grade1.dev.0.1.json
('use pickle', 1)
Longest sentence length 128
Longest story length 171
Answer length 60
Label size 4
Training set shape (2129, 100, 128)
Training Size 2129
Validation Size 533
Testing Size 325
('q_emb', <tf.Tensor 'MemN2N2/embedding_lookup:0' shape=(?, 128, 50) dtype=float32>)
('self._encoding', <tf.Tensor 'encoding:0' shape=(128, 50) dtype=float32>)
('u_0', <tf.Tensor 'MemN2N2/Sum:0' shape=(?, 50) dtype=float32>)
('as_emb', <tf.Tensor 'MemN2N2/embedding_lookup_7:0' shape=(?, 4, 60, 50) dtype=float32>)
('self._answer_encoding', <tf.Tensor 'answer_encoding:0' shape=(60, 50) dtype=float32>)
('as_enc', <tf.Tensor 'MemN2N2/Sum_13:0' shape=(?, 4, 50) dtype=float32>)
('u_k', <tf.Tensor 'MemN2N2/Relu_2:0' shape=(?, 50) dtype=float32>)
('u_k_l', <tf.Tensor 'MemN2N2/Reshape:0' shape=(?, 4, 50) dtype=float32>)
('as_ans', <tf.Tensor 'MemN2N2/Sub:0' shape=(?, 4, 50) dtype=float32>)
('as_ans', <tf.Tensor 'MemN2N2/Sum_14:0' shape=(?, 4) dtype=float32>)
('logits', <tf.Tensor 'MemN2N2/Sum_14:0' shape=(?, 4) dtype=float32>)
-----------------------
Epoch 1
Total Cost: 190761.47998
Training Accuracy: 0.376232973227
Validation Accuracy: 0.315197
-----------------------
Testing Accuracy: 0.344615384615
-----------------------
Epoch 2
Total Cost: 109136.716919
Training Accuracy: 0.537341474871
Validation Accuracy: 0.427767
-----------------------
Testing Accuracy: 0.409230769231
-----------------------
Epoch 3
Total Cost: 66506.928833
Training Accuracy: 0.660403945514
Validation Accuracy: 0.472795
-----------------------
Testing Accuracy: 0.393846153846
-----------------------
Epoch 4
Total Cost: 47281.1495972
Training Accuracy: 0.763738844528
Validation Accuracy: 0.540338
-----------------------
Testing Accuracy: 0.412307692308
-----------------------
Epoch 5
Total Cost: 37214.1437378
Training Accuracy: 0.788633161109
Validation Accuracy: 0.545966
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 6
Total Cost: 29908.7781372
Training Accuracy: 0.835133865665
Validation Accuracy: 0.56848
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 7
Total Cost: 28779.6509399
Training Accuracy: 0.894786284641
Validation Accuracy: 0.559099
-----------------------
Testing Accuracy: 0.406153846154
-----------------------
Epoch 8
Total Cost: 23952.9991455
Training Accuracy: 0.855331141381
Validation Accuracy: 0.523452
-----------------------
Testing Accuracy: 0.381538461538
-----------------------
Epoch 9
Total Cost: 21521.9996948
Training Accuracy: 0.919210897135
Validation Accuracy: 0.592871
-----------------------
Testing Accuracy: 0.396923076923
-----------------------
Epoch 10
Total Cost: 16416.7961426
Training Accuracy: 0.939877876938
Validation Accuracy: 0.598499
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 11
Total Cost: 13154.508606
Training Accuracy: 0.946923438234
Validation Accuracy: 0.611632
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 12
Total Cost: 11159.8668823
Training Accuracy: 0.952090183185
Validation Accuracy: 0.600375
-----------------------
Testing Accuracy: 0.458461538462
-----------------------
Epoch 13
Total Cost: 10418.3409729
Training Accuracy: 0.957256928135
Validation Accuracy: 0.628518
-----------------------
Testing Accuracy: 0.452307692308
-----------------------
Epoch 14
Total Cost: 9490.63209534
Training Accuracy: 0.96054485674
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.449230769231
-----------------------
Epoch 15
Total Cost: 8119.98660278
Training Accuracy: 0.961014560827
Validation Accuracy: 0.636023
-----------------------
Testing Accuracy: 0.436923076923
-----------------------
Epoch 16
Total Cost: 7866.21800232
Training Accuracy: 0.96712071395
Validation Accuracy: 0.634146
-----------------------
Testing Accuracy: 0.446153846154
-----------------------
Epoch 17
Total Cost: 7152.35258484
Training Accuracy: 0.951150775012
Validation Accuracy: 0.613508
-----------------------
Testing Accuracy: 0.433846153846
-----------------------
Epoch 18
Total Cost: 7434.45574951
Training Accuracy: 0.96712071395
Validation Accuracy: 0.624765
-----------------------
Testing Accuracy: 0.430769230769
-----------------------
Epoch 19
Total Cost: 5777.96362305
Training Accuracy: 0.968060122123
Validation Accuracy: 0.609756
-----------------------
Testing Accuracy: 0.418461538462
-----------------------
Epoch 20
Total Cost: 4968.02074432
Training Accuracy: 0.988257397839
Validation Accuracy: 0.641651
-----------------------
Testing Accuracy: 0.467692307692
-----------------------
Epoch 21
Total Cost: 4548.97806549
Training Accuracy: 0.971348050728
Validation Accuracy: 0.tune.sh: line 11: 10261 Terminated              python mc_single.py --task $task --embedding_size $db --regularization $l2
tune.sh: line 19: syntax error near unexpected token `done'
tune.sh: line 19: ` done'
